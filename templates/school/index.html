{% extends "base.html" %}
{% block content %}
<div class="min-h-screen py-8 px-4">
    <div class="max-w-6xl mx-auto">
        <!-- Header -->
        <div class="flex items-center justify-between mb-8">
            <div class="flex items-center gap-4">
                <a href="{{ url_for('dashboard') }}" class="text-slate-400 hover:text-slate-600">
                    <i class="fa-solid fa-arrow-left text-xl"></i>
                </a>
                <div>
                    <h1 class="text-3xl font-extrabold text-slate-800">{{ grade.name }}</h1>
                    <p class="text-slate-500">Your Class Schedule</p>
                </div>
            </div>
            <a href="{{ url_for('school.select_grade') }}"
                class="px-4 py-2 bg-slate-100 hover:bg-slate-200 rounded-xl text-slate-600 font-medium text-sm transition-all">
                <i class="fa-solid fa-repeat mr-2"></i> Change Grade
            </a>
        </div>

        <!-- ONGOING CLASSES (LIVE) -->
        {% if ongoing %}
        <div class="mb-8 animate-fade-in-up">
            <h2 class="text-xl font-bold text-slate-700 mb-4 flex items-center gap-2">
                <span class="w-3 h-3 bg-red-500 rounded-full animate-pulse"></span> Ongoing Classes
            </h2>
            <div class="grid gap-4 md:grid-cols-2">
                {% for cls in ongoing %}
                <div
                    class="bg-gradient-to-r from-red-500 to-pink-600 rounded-2xl p-6 text-white shadow-lg shadow-red-200">
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <h3 class="text-2xl font-bold">{{ cls.subject.name }}</h3>
                            <p class="text-red-100"><i class="fa-solid fa-chalkboard-user mr-1"></i> {{
                                cls.teacher.display_name if cls.teacher else 'No Tutor' }}</p>
                        </div>
                        <span class="px-3 py-1 bg-white/20 backdrop-blur rounded-lg text-sm font-bold animate-pulse">
                            <i class="fa-solid fa-video mr-1"></i> LIVE
                        </span>
                    </div>
                    <div class="flex justify-between items-center mt-4">
                        <div class="text-sm text-red-100">
                            Started at {{ cls.start_time }}
                        </div>
                        <a href="{{ url_for('school.join_class', class_id=cls.id) }}"
                            class="px-6 py-2 bg-white text-red-600 font-bold rounded-xl hover:bg-red-50 transition-colors shadow-sm">
                            Join Now
                        </a>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}

        <!-- UPCOMING CLASSES -->
        <div class="mb-8">
            <h2 class="text-xl font-bold text-slate-700 mb-4 flex items-center gap-2">
                <i class="fa-regular fa-calendar-check text-violet-500"></i> Upcoming Classes
            </h2>
            {% if upcoming %}
            <div class="grid gap-4 md:grid-cols-3">
                {% for cls in upcoming %}
                <div class="bg-white rounded-2xl p-5 border border-slate-200 hover:shadow-md transition-all group">
                    <div class="flex justify-between items-start mb-3">
                        <div
                            class="w-10 h-10 rounded-lg bg-violet-100 text-violet-600 flex items-center justify-center font-bold">
                            {{ cls.subject.name[:1] }}
                        </div>
                        <div class="text-xs font-bold text-slate-400 bg-slate-50 px-2 py-1 rounded">
                            {{ cls.scheduled_date.strftime('%b %d') }}
                        </div>
                    </div>
                    <h3 class="font-bold text-lg text-slate-800 mb-1 group-hover:text-violet-600 transition-colors">{{
                        cls.subject.name }}</h3>
                    <p class="text-sm text-slate-500 mb-3">
                        <i class="fa-regular fa-clock mr-1"></i> {{ cls.start_time }} - {{ cls.end_time }}
                    </p>
                    <div class="text-xs text-slate-400 flex items-center gap-1">
                        <i class="fa-solid fa-user-tie"></i> {{ cls.teacher.display_name if cls.teacher else 'TBA' }}
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <div class="text-center py-10 bg-slate-50 rounded-2xl border border-dashed border-slate-300">
                <p class="text-slate-400">No upcoming classes scheduled.</p>
            </div>
            {% endif %}
        </div>

        <!-- COMPLETED CLASSES -->
        {% if completed %}
        <div class="mb-8 opacity-75">
            <h2 class="text-lg font-bold text-slate-600 mb-4 flex items-center gap-2">
                <i class="fa-solid fa-check-circle text-slate-400"></i> Completed
            </h2>
            <div class="space-y-3">
                {% for cls in completed %}
                <div class="bg-slate-50 rounded-xl p-4 flex items-center justify-between border border-slate-100">
                    <div class="flex items-center gap-4">
                        <div class="text-slate-400 font-bold text-sm w-16">{{ cls.scheduled_date.strftime('%b %d') }}
                        </div>
                        <div>
                            <h4 class="font-bold text-slate-700">{{ cls.subject.name }}</h4>
                            <p class="text-xs text-slate-500">{{ cls.teacher.display_name if cls.teacher else 'No Tutor'
                                }}</p>
                        </div>
                    </div>
                    {% if cls.recording_url %}
                    <a href="{{ cls.recording_url }}" target="_blank"
                        class="text-xs font-bold text-violet-600 hover:underline">
                        <i class="fa-solid fa-play-circle"></i> Watch Recording
                    </a>
                    {% else %}
                    <span class="text-xs text-slate-400">Completed</span>
                    {% endif %}
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}

    </div>
</div>
{% endblock %}