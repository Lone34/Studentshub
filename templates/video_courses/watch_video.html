{% extends "base.html" %}
{% block content %}

<div class="max-w-5xl mx-auto animate-fade-in pb-20">

    <!-- Back Navigation -->
    <div class="mb-4 flex items-center justify-between">
        <a href="{{ url_for('video_courses.course_detail', course_id=course.id) }}"
            class="text-slate-500 hover:text-indigo-600 transition-colors text-sm font-medium">
            <i class="fa-solid fa-arrow-left mr-1"></i> {{ course.title }}
        </a>
        <span class="text-slate-400 text-xs font-medium">
            {{ current_idx + 1 }} / {{ total_videos }} Videos
        </span>
    </div>

    <!-- Video Player -->
    <div class="bg-black rounded-2xl overflow-hidden shadow-2xl mb-6 relative">
        <video id="video-player" controls autoplay class="w-full max-h-[70vh]" controlsList="nodownload"
            oncontextmenu="return false;">
            <source src="{{ url_for('static', filename=video.file_path) }}" type="video/mp4">
            Your browser does not support the video tag.
        </video>
    </div>

    <!-- Video Info Card -->
    <div class="bg-white rounded-2xl shadow-sm border border-slate-100 p-6 mb-6">
        <div class="flex flex-col md:flex-row items-start md:items-center justify-between gap-4 mb-4">
            <div>
                <h1 class="text-xl font-extrabold text-slate-800 mb-1">{{ video.title }}</h1>
                <div class="flex items-center gap-3 text-xs text-slate-400">
                    <span><i class="fa-solid fa-folder mr-1"></i> {{ course.title }}</span>
                    {% if video.duration_seconds > 0 %}
                    <span><i class="fa-regular fa-clock mr-1"></i> {{ (video.duration_seconds // 60) }}:{{ '%02d' %
                        (video.duration_seconds % 60) }}</span>
                    {% endif %}
                    {% if video.file_size_mb > 0 %}
                    <span><i class="fa-solid fa-hard-drive mr-1"></i> {{ video.file_size_mb }} MB</span>
                    {% endif %}
                </div>
            </div>
        </div>

        {% if video.description %}
        <p class="text-slate-600 text-sm leading-relaxed border-t border-slate-100 pt-4">{{ video.description }}</p>
        {% endif %}
    </div>

    <!-- Navigation Buttons -->
    <div class="flex items-center justify-between gap-4">
        {% if prev_video %}
        <a href="{{ url_for('video_courses.watch_video', course_id=course.id, video_id=prev_video.id) }}"
            class="flex-1 bg-white border border-slate-200 hover:border-indigo-300 hover:bg-indigo-50 text-slate-600 hover:text-indigo-600 px-5 py-3 rounded-xl font-bold text-sm transition-all flex items-center gap-3 group">
            <i class="fa-solid fa-chevron-left text-slate-400 group-hover:text-indigo-500 transition-colors"></i>
            <div class="min-w-0">
                <div class="text-[10px] text-slate-400 font-medium uppercase">Previous</div>
                <div class="truncate">{{ prev_video.title }}</div>
            </div>
        </a>
        {% else %}
        <div class="flex-1"></div>
        {% endif %}

        {% if next_video %}
        <a href="{{ url_for('video_courses.watch_video', course_id=course.id, video_id=next_video.id) }}"
            class="flex-1 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white px-5 py-3 rounded-xl font-bold text-sm transition-all flex items-center justify-end gap-3 group shadow-lg shadow-indigo-500/20">
            <div class="min-w-0 text-right">
                <div class="text-[10px] text-white/70 font-medium uppercase">Next</div>
                <div class="truncate">{{ next_video.title }}</div>
            </div>
            <i class="fa-solid fa-chevron-right text-white/70 group-hover:text-white transition-colors"></i>
        </a>
        {% else %}
        <a href="{{ url_for('video_courses.course_detail', course_id=course.id) }}"
            class="flex-1 bg-emerald-500 hover:bg-emerald-600 text-white px-5 py-3 rounded-xl font-bold text-sm transition-all flex items-center justify-end gap-3 shadow-lg shadow-emerald-500/20">
            <div class="text-right">
                <div class="text-[10px] text-white/70 font-medium uppercase">Finished!</div>
                <div>Back to Course</div>
            </div>
            <i class="fa-solid fa-check-circle"></i>
        </a>
        {% endif %}
    </div>
</div>

<style>
    /* Hide download button on video player */
    video::-webkit-media-controls-enclosure {
        overflow: hidden;
    }

    video::-internal-media-controls-download-button {
        display: none;
    }

    @keyframes fade-in {
        from {
            opacity: 0;
            transform: translateY(20px);
        }

        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .animate-fade-in {
        animation: fade-in 0.5s ease-out;
    }
</style>
{% endblock %}